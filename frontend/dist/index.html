<html>
	<head>
		<meta charset="utf-8">
		<meta name="author" content="Timm,Denny,Julian" >
		<meta name="description" content="A marebling tool">
		<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
		<link rel="icon" href="favicon.png" size="96x96" type="image/png">
		<link rel="apple-touch-icon" size="180x180" href="apple-touch-icon.png">
		<meta name="msapplication-TileColor" content="#ffffff">
		<meta name="msapplication-TileImage" content="mstile-144x144x.png">
		<link rel="stylesheet" href="stylesheet.css">
		<script>
			function switchStore() {
				if(switchStore.input.checked) {
					window.localStorage.setItem('store-active', '1');
				} else {
					if(window.confirm('When you disable browser storage all stored options will be cleared.\nThere is no way to undo this!')) {
						window.storage.backup()
						window.localStorage.clear();
					} else {
						switchStore.input.checked = true
					}
				}
				if(window.storage) {
					try {
						window.storage = new window.Storage()
					} catch (e) {
						window.alert('Failed to enable storing!\nThis may caused by the Application is not fully loaded!')
						console.error(e)
						switchStore.input.checked = false
					}
				}
			}
			document.addEventListener('DOMContentLoaded', function() {
				const input = document.getElementById('store-active')
				switchStore.input = input
				input.checked = window.localStorage.getItem('store-active');
			});
		</script>
		<script src="index.js"></script>
		<script src="Marbellous.js"></script>
		<title>Marbellous</title>
	</head>
	<body>
	<noscript>
		<div style="position: absolute; top:50%;left:25%; z-index: 10;background: #EEE; border: solid gray 5px;transform: translate(-16%,-50%);min-width:75%;text-align:center;">
			<p style="margin: 30 30 0 30">
				<b>You must enable JavaScript to use Marbellous in your browser.</b>
			</p><p style="margin: 15 30 30 30">
				Please consider one of the following guides if you don't know how: <a href="https://www.enablejavascript.io/en">https://www.enablejavascript.io/en</a>
			</p>
		</div>
	</noscript>
	<input id="sidebar-btn" type="checkbox" class="sidebar">
	<label for="sidebar-btn" class="sidebar">
		<img src="icons/arrow-right-solid.svg" title="">
	</label>
	<menu class="sidebar">
		<!-- help menu -->
		<li>
				<input type="radio" name="sidebar" id="sidebar-help"/>
				<label for="sidebar-help">Help</label>
				<div>
					Bla bla helpful<br>
					explain rake syntax (TODO)
				</div>
		</li>
		<!-- general -->
		<li>
				<input type="radio" name="sidebar" id="sidebar-general" />
				<label for="sidebar-general">General</label>
				<div>
					<table>
						<tr>
							<td><label title="Enable to store settings in browser. This will persist the settings even when you close and revisit the site later. This only effects settings which you changed after enabling storing!">store settings</label></td>
							<td><label class="switch" title="Enable to store settings in browser. This will persist the settings even when you close and revisit the site later. This only effects settings which you changed after enabling storing!">
									<input id="store-active" class="slider" type="checkbox" onclick="switchStore()">
									<span class="slider"></span>
								</label></td>
						</tr>
						<tr>
							<td><label title="Use image post processing to reduce noise and rough edges.\nThis may results in display errors (known platform Safarie on MacOS). If this the case please disable it!.">
									post processing</label></td>
							<td><label class="switch" title="Use image post processing to reduce noise and rough edges.\nThis may results in display errors (known platform Safarie on MacOS). If this the case please disable it!.">
								<input id="sidebar-filter" class="slider" type="checkbox">
								<span class="slider"></span>
							</label></td>
						</tr>
						</tr><tr>
							<td>
								<label for="sidebar-general-resolution" title="Set resolution for image.\nA high resolution may result in lags and crashes!">
								resolution: </label>
								</td>
							<td>
								<select class="form_field" id="sidebar-general-resolution">
									<option value="720">720x720</option>
									<option value="1080" selected>1080x1080</option>
									<option value="2160">2160x2160</option>
									<option value="3840">3840x3840</option>
								</select></td></tr>
					</table>
				</div>
		</li>
		<!-- rake -->
		<li>
				<input type="radio" name="sidebar" id="sidebar-rake"/>
				<label for="sidebar-rake">Rake</label>
				<div><menu style="width:75%;list-style:none;margin-left:-40px;">
						<li class="form_group field">
							<input class="form_field"
								   placeholder="placement"
								   title="<offset>:<space>(,<space>)*"
								   id="sidebar-rake-placement"
								   type="text" autocomplete="on"
											   pattern="([0-9]+:)?([0-9]+,)*[0-9]+"
											   value=""/>
							<label class="form_label"
								   for="sidebar-rake-placement"
								   title="space between nails in rake">
								placement
							</label>
						</li>
						<li class="form_group field">
							<input class="form_field"
								   placeholder="periode"
								   title="<periode in %>"
								   id="sidebar-rake-periode"
								   type="number" min="0" max="100" step="1"
																   value=""/>
							<label class="form_label"
								   for="sidebar-rake-periode"
								   title="periode of wave rake movment">
								periode
							</label>
						</li>
						<li class="form_group field">
							<input class="form_field"
								   placeholder="magnitude"
								   title="<magnitude in %>"
								   id="sidebar-rake-magnitude"
								   type="number" min="0" max="100" step="1"
																   value="">
							<label class="form_label"
								   for="sidebar-rake-magnitude"
								   title="magnitude of wave rake movement">
								magnitude
							</label>
						</li>
					</menu></div>
		</li>
		<!-- pallet -->
		<li>
				<input type="radio" name="sidebar" id="sidebar-pallet"/>
				<label for="sidebar-pallet">Pallet</label>
				<div>
					<table>
						<tr>
							<td>
								<label for="sidebar-pallet-active-pallet" title="select current pallet">
								color theme: </label>
								</td>
							<td>
								<select class="form_field" name="active-pallet" id="sidebar-pallet-active-pallet">
									<option value="pallet-1">default</option>
									<option value="pallet-2">light</option>
									<option value="pallet-3">funky</option>
								</select></td>						</tr><tr>
									<td>Colors</td><td></td><td>Ratio</td>
						</tr><tr class ="sub-row">
							<td><label for="sidebar-pallet-color-0">A:</label></td>
							<td><input id="sidebar-pallet-color-0" type="color"
								value="#3E1404"></td>
							<td><input class="form_field"
									   id="sidebar-pallet-ratio-0" type="number" value="1"
									   min="0" step="1" max="999" size="2"></td>
						</tr><tr class="sub-row">
							<td><label for="sidebar-pallet-color-1">B:</label></td>
							<td><input id="sidebar-pallet-color-1" type="color"
								value="#6A2B05"></td>
							<td><input class="form_field"
									   id="sidebar-pallet-ratio-1" type="number" value="1"
									   min="0" step="1" max="999" size="2"></td>
						</tr><tr class="sub-row">
							<td><label for="sidebar-pallet-color-2">C:</label></td>
							<td><input id="sidebar-pallet-color-2" type="color"
								value="#964315"></td>
							<td><input class="form_field"
									   id="sidebar-pallet-ratio-2" type="number" value="1"
									   min="0" step="1" max="999" size="2"></td>
						</tr><tr class="sub-row">
							<td><label for="sidebar-pallet-color-3">D:</label></td>
							<td><input id="sidebar-pallet-color-3" type="color"
								   value="#BB6B24"></td>
							<td><input class="form_field"
									   id="sidebar-pallet-ratio-3" type="number" value="1"
									   min="0" step="1" max="999" size="2"></td>
						</tr><tr>
							<td><label for='sidebar-pallet-background'>Background:</label></td>
							<td><input id="sidebar-pallet-background" type="color"
								value="#F7E9CE"></td>
						</tr>
					</table>
				</div>
		</li>
		<!-- color grid -->
		<!-- <li>
			<input type="radio" name="sidebar" id="sidebar-colorgrid">
			<label for="sidebar-colorgrid">Colorgrid</label>
			<div>
				<menu style="width:75%;list-style:none;margin-left:-40px">
					<li class="form_group field">
						<input	class="form_field"
								placeholder="cell width"
								title="<cell width in % canvas size>"
								id="sidebar-colorgrid-width"
								type="number" min="1" step="1" value="">
						<label for="sidebar-colorgrid-width"
								title="Determines the width of an grid cell.\nHorizontel space between to columns"
								class="form_label">
							cell width
							</label>
					</li>
					<li class="form_group field">
						<input	class="form_field"
								placeholder="cell height"
								title="<cell height in % canvas size>"
								id="sidebar-colorgrid-height"
								type="number" min="1">
						<label class="form_label"
							   title="Determines the verticaal space between grid cells in the same column.">
							cell height
						</label>
					</li>
					<li class="form_group field">
						<input	class="form_field"
								placeholder="cell offset"
								title="<cell offset in % canvas size>"
								id="sidebar-colorgrid-offset"
								type="number" step="1" value="">
						<label for="sidebar-colorgrid-offset"
							   title="Shift between two adjenten columns.\nApplied alternating positive and negative"
							   class="form_label">
							cell offset
						</label>
					</li>
					<li>
						<table style="margin-top:20px">
							<tr>
								<td>
						<label class="switch" title="Colorgrid drops are in random color.">
							<input id="sidebar-colorgrid-random_color" class="slider" type="checkbox">
							<span class="slider"></span>
						</label>
						</td>
						<td><p>random color for each drop</p></td>
						</tr>
						</table>
					</li>
				</menu>
			</div>
		</li> -->
		<!-- sprinkler -->
		<li>
			<input type="radio" name="sidebar" id="sidebar-sprinkler"/>
			<label for="sidebar-sprinkler">Sprinkler</label>
			<div>
				<menu style="width:75%;list-style:none;margin-left:-40px;">
					<li class="form_group field">
						<input 	class="form_field"
							   	placeholder="size min-max"
							   	title="<min> - <max>"
								id="sidebar-sprinkler-radius"
 							   	type="text" autocomplete="on"
 	 							pattern="([1-9][0-9]?|100)-([1-9][0-9]?|100)+"
								value="">
						<label class="form_label"
							   for="sidebar-sprinkler-radius"
							   title="Size range for drops dropped by sprinkler tool.">
							size min-max
						</label>
						<div id="sidebar-sprinkler-radius-slider"></div>
					</li>
					<li class="form_group field">
						<input 	class="form_field"
								placeholder="drop frequence"
								id="sidebar-sprinkler-frequence"
								type="number" autocomplete="on"
								value=""
								min="1" step="1" max="20">
						 <label class="form_label"
							 	for="sidebar-sprinkler-frequence"
								title="Drops per second placet by the sprinkler tool.">
							 drop frequence
						 </label>
						 <div id="sidebar-sprinkler-frequence-slider"></div>
					</li>
					<li><label class="switch" title="Sparkle drops only around cursor. If disable drops will sparkle in the full area." style="margin-top:20px">
							<input id="sidebar-sprinkler-local" class="slider" type="checkbox">
							<span class="slider"></span>
						</label>
						sparkle around cursor
						<menu style="list-style:none;margin-top:-10px">
							<li class="form_group field">
								<input class="form_field"
									   placeholder="σ"
									   disabled
									   id="sidebar-sprinkler-sig"
									   type="number" autocomplete="on"
									   value=""
									   min="1" step="1" max="100">
								<label class="form_label"
									    for="sidebar-sprinkler-sig"
										title="Standart deviation for dropps to be generated.">
									σ
								</label>
								<div id="sidebar-sprinkler-sig-slider"></div>
							</li>
						</menu>
					</li>
				</menu>
			</div>
		</li>
	</menu>
	</menu>
	<div id="content" style="height:100%"><menu class="menu">
			<li class="draw state"><input type="radio" id="color-picker" name="menu">
				<label for="color-picker" title="select a color to apply">
					<img src="icons/palette-solid.svg" alt="color picker">
				</label><!-- romves whitespaces
				--><menu option="pallet">
					<li><input type="radio" id="color-0" name="color-picker" checked>
						<label for="color-0" title="change to color 1">
							<img src="icons/empty.svg" alt="color-0">
						</label>
					</li>
					<li><input type="radio" id="color-1" name="color-picker">
						<label for="color-1" title="change to color 2">
							<img src="icons/empty.svg" alt="color-1">
						</label>
					</li>
					<li><input type="radio" id="color-2" name="color-picker">
						<label for="color-2" title="change to color 3">
							<img src="icons/empty.svg" alt="color-2">
						</label>
					</li>
					<li><input type="radio" id="color-3" name="color-picker">
						<label for="color-3" title="change to color 3">
							<img src="icons/empty.svg" alt="color-3">
						</label>
				</menu>
			</li>

			<li class="rake state"><input type="radio" id="rake-movement" name="menu">
				<label for="rake-movement" title="select movement for rake">
					<img src="icons/movement.svg">
				</label>
				<menu option="rake">
					<li><input type="radio" id="rake-movement-linear" name="rake-movement" checked>
						<label for="rake-movement-linear" title="Move rake straigth">
							<img src="icons/straight.svg">
						</label>
					</li>
					<li><input type="radio" id="rake-movement-wave" name="rake-movement">
						<label for="rake-movement-wave" title="Move rake in wave like facion.">
							<img src="icons/wave.svg">
						</label>
					</li>
				</menu>
			</li>

			<li class="draw state"><input type="radio" id="color-dropper" name="menu" checked>
				<label for="color-dropper" title="Create color blobs at position when applied. Hold for larger drops">
					<img src="icons/eye-dropper-solid.svg" alt="color dropper">
				</label>
			</li>

			<li class="draw state"><input type="radio" id="color-sprinkler" name="menu">
				<label for="color-sprinkler" title="Apply color in random pattern. Hold for more drops.">
					<img src="icons/sparkle-solid.svg" alt="color sprinkler">
				</label>
			</li>

			<!-- <li class="draw state"><input type="radio" id="color-rake" name="menu">
				<label for="color-rake" title="Apply color in regular pattern. Hold for larger drops.">
					<img src="icons/regular-rake-solid.svg">
				</label>
			</li> -->

			<li><input type="button" id="clear" name="history">
				<label for="clear" title="Clear canvas">
					<img src="icons/chalkboard-solid.svg" alt="clear canvas">
				</label>
			</li>
			<li class="rake state"><input type="button" id="undo" name="history" disabled>
				<label for="undo" title="Undo one rake step.">
					<img src="icons/undo-solid.svg" alt="undo rake">
				</label>
			</li>
			<li><input type="button" id="switch-state" name="history">
				<label for="switch-state" title="Start rakeing!">
					<img src="icons/arrow-right-solid.svg">
				</label>
			</li>

			<li><input type="button" id="download">
				<label for="download" title="Download current canvas state as image" style="position:relative;">
					<img src="icons/file-download-solid.svg" alt="download" >
					<div class="spinner" style="position:absolute" hidden>
						<svg 
							width="32px" height="32px" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg" >
							<circle class="path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30">
							</circle>
						</svg>
					</div>
				</label>
			</li>

		</menu><!-- removes whitespace
			--><div style="display:table-cell"><h1 style="text-align:center">Marbellous</h1><div class="page">
			<canvas width="720" height="720" id="image" style="background: #f7e9ce;"></canvas>
			<canvas width="720" height="720" id="overlay"></canvas>
		</div>
		<p class="notice">The source code and legal notice can be found at the <a href="https://github.com/t-erxleben/marbellous">Marbellous</a> GitHub repository.</p></div>
		</div>
		<img style="display: none" id="img-color-dropper" width="32" height="32" src="icons/eye-dropper-solid.png">
		<img style="display: none" id="img-color-sparkle" width="32" height="32" src="icons/sparkle-solid.png">
	</body>
</html>
